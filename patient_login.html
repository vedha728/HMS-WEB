{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Patient Login - HealthPoint Clinic</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Add your custom styles here -->
  <style>
    body { background-color: #f8f9fa; font-family: Arial, sans-serif; }
    .hero-section {
      background: linear-gradient(to right, #007bff, #6610f2);
      color: white;
      padding: 4rem 2rem;
      text-align: center;
      position: relative;
    }
    .card { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); margin: 20px 0; }
    .dashboard { display: none; }
    .language-switcher {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 120px;
    }
    footer {
      background-color: #343a40;
      color: #fff;
      padding: 0.5rem 0;         /* Lower vertical padding! */
      text-align: center;
      width: 800px;               /* Match your main card/container width */
      margin: 2rem auto 0 auto;   /* Top margin, centered */
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08); /* Subtle shadow */
      position: static;           /* Let content push it down, don't block */
      font-size: 1rem;
      border-top: 2px solid #eee;
    }
    @media (max-width: 900px) {
        footer {
            width: 96vw;
            border-radius: 0;
        font-size: 0.95rem;
      }
    }
    .clinic-info {
      background-color: #ffffff;
      padding: 2rem;
      margin: 2rem auto;
      text-align: center;
      max-width: 800px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    footer {
      background-color: #343a40;
      color: #fff;
      padding: 1.5rem 0;
      text-align: center;
      position: fixed;
      bottom: 0;
      width: 100%;
      left: 0;
    }
  </style>
</head>
<body>
    <!-- Patient Authentication -->
    <div id="patientAuth" class="container mt-5 dashboard">
        <div class="row justify-content-center">
            <div class="col-md-6">
              <div class="card">
                <div class="card-body">
                   <h3 class="text-center">Patient Login</h3>
                   <form onsubmit="handlePatientLogin(event)">
                     <input type="email" id="loginEmail" class="form-control mb-3" placeholder="Email" required>
                     <input type="password" id="loginPassword" class="form-control mb-3" placeholder="Password" required>
                     <button type="submit" class="btn btn-primary w-100" id="patientLoginBtn">Login</button>
                   </form>
                   <p class="text-center mt-3">New User? 
                     <a href="#" onclick="showSection('patientSignup')">Create Account</a>
                   </p>
                </div>
               </div>
            </div>
        </div>
    </div>
    <!-- Patient Signup -->
    <div id="patientSignup" class="container mt-5 dashboard">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h3 class="text-center">Create Account</h3>
                        <form onsubmit="handleSignup(event)">
                            <input type="hidden" id="csrftoken" value="{{ csrf_token }}">
                            <input type="email" name="email" class="form-control mb-3" placeholder="Email" required>
                            <input type="password" name="password" class="form-control mb-3" placeholder="Password" required>
                            <button type="submit" class="btn btn-success w-100" id="patientSignupBtn">Sign Up</button>
                        </form>
                        <p class="text-center mt-3">
                            <a href="#" onclick="showSection('patientAuth')">Already have an account? Login</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Patient Dashboard -->
    <div id="patientDashboard" class="container mt-5 dashboard">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Patient Dashboard</h2>
        <button class="btn btn-outline-danger" onclick="logout()">Logout</button>
      </div>
      <div class="card mt-4">
        <div class="card-body">
            <div class="alert alert-info" id="notification" style="display: none;"></div>
            <h4>Your Appointments</h4>
            <div id="patientAppointments"></div>
        </div>
    </div>
    <!-- Profile Section -->
    <div class="card">
      <div class="card-body">
        <h4>Personal Details</h4>
          <form onsubmit="saveProfile(event)">
            <div class="row g-3">
              <div class="col-md-3">
                <input type="text" id="firstName" autocomplete="given-name"class="form-control " placeholder="First Name" required>
              </div>
              <div class="col-md-3">
                  <input type="text" id="lastName" autocomplete="family-name" class="form-control" placeholder="Last Name" required>
              </div> 
              <div class="col-md-3">
                <input type="number" id="age" class="form-control" placeholder="Age" required>
              </div>
              <div class="col-md-3">
                <select id="bloodGroup" class="form-select" required>
                  <option value="">Blood Group</option>
                  <option>A+</option><option>A1+</option><option>B+</option><option>O+</option><option>O-</option><option>AB+</option><option>AB-</option>
                </select>
              </div>
              <div class="col-md-6">
                <input type="tel" id="mobile" class="form-control w-50" placeholder="Mobile Number" required>
              </div>
              <div class="col-12">
                <button type="button" id="editProfileBtn" onclick="enableProfileEditing()">Edit Profile</button>
                  <button type="submit" id="saveProfileBtn" disabled>Save Profile</button>
              </div>
            </div>
          </form>
      </div>
    </div>

    <!-- Upload Past Medical Records -->
    <div class="card mt-4">
      <div class="card-body">
        <h4>Upload Your Past Medical Records</h4>
        <form id="medicalRecordForm" enctype="multipart/form-data">
          <div class="mb-3">
            <input type="file" id="medicalRecordFile" class="form-control" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" required>
            <div class="form-text">Max file size: 1MB. Accepted formats: PDF, JPG, PNG, DOC, DOCX.</div>
          </div>
          <button type="submit" class="btn btn-primary">Upload</button>
          <div id="uploadStatus" class="mt-2"></div>
        </form>
      </div>
    </div>
    <!-- Appointment Booking -->
    <div class="card mt-4">
      <div class="card-body">
          <h4>Book Appointment</h4>
          <form onsubmit="bookAppointment(event)">
            <div class="row g-3">
              <div class="col-md-6">
                <select id="serviceType" class="form-select" required>
                  <option value="">Select Service</option>
                  <option>General Checkup</option>
                  <option>Eye Care</option>
                  <option>Dental Care</option>
                  <option>Blood test</option>
                  <option>Diabetes test</option>
                  <option>X-ray</option>
                  <option>PT scan</option>
                  <option>Vaccination</option> 
                </select>
              </div>
              <div class="col-md-12">
                <label for="reasonForVisit" class="form-label mt-2">Reason for Visit</label>
                <textarea id="reasonForVisit" class="form-control" rows="3" placeholder="Describe your reason for visiting the clinic" required></textarea>
              </div>          
              <div class="mb-3">
                <input type="date" id="appointmentDate" class="form-control w-50" required>
              </div>
              <div class="mb-3">
                <select id="appointmentTime" class="form-select w-50" required>
                  <option value="">Select Time</option>
                  <option value="09:00">9 AM</option>
                  <option value="10:00">10 AM</option>
                  <option value="11:00">11 AM</option>
                  <option value="12:00">12 PM</option>
                  <option value="14:00">2 PM</option>
                  <option value="15:00">3 PM</option>
                  <option value="16:00">4 PM</option>
                  <option value="17:00">5 PM</option>
                  <option value="18:00">6 PM</option>
                  <option value="19:00">7 PM</option>
                </select>
              </div>
              <div class="text-center">
                <button type="submit" class="btn btn-success w-30">Book Appointment</button>
              </div>
            </div>
          </form>
      </div>
    </div>
    <!-- Pharmacy Section (inside dashboard) -->
    <div id="pharmacySection" class="card mt-4">
      <div class="card-body">
          <h4>Pharmacy</h4>
          <form id="pharmacyForm">
            <div class="mb-3">
              <label for="pharmacyAddress" class="form-label">Delivery Address</label>
              <textarea id="pharmacyAddress" class="form-control" rows="2" placeholder="Enter your address" required></textarea>
            </div>
            <div class="mb-3">
              <label for="pharmacyPincode" class="form-label">Pin Code</label>
              <input type="text" id="pharmacyPincode" class="form-control w-50" placeholder="Pin Code" required pattern="\d{6}">
            </div>
            <div class="mb-3">
              <label class="form-label">Select Medicines (based on your selected service):</label>
              <div id="medicineList"></div>
            </div>
            <button type="submit" class="btn btn-primary">Place Order</button>
            <div id="pharmacyOrderStatus" class="mt-2"></div>
          </form>
          <div id="pharmacyPayment" class="mt-3" style="display:none;">
            <h5>Payment</h5>
            <div class="mb-2">
              <label class="form-label">Select Payment Method:</label><br>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="paymentMethod" id="upiOption" value="UPI" checked>
                <label class="form-check-label" for="upiOption">UPI</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="paymentMethod" id="netbankingOption" value="Netbanking">
                <label class="form-check-label" for="netbankingOption">Netbanking</label>
              </div>
            </div>
            <div id="upiSection" class="mb-2">
              <label for="upiId" class="form-label">Enter UPI ID:</label>
              <input type="text" id="upiId" class="form-control w-50" placeholder="example@upi">
            </div>
            <div id="netbankingSection" class="mb-2" style="display:none;">
              <label for="bankName" class="form-label">Select Bank:</label>
              <select id="bankName" class="form-select w-50">
                <option value="">Choose Bank</option>
                <option>City Union Bank</option>
                <option>Canara Bank</option>
                <option>State Bank of India</option>
                <option>IOB Bank</option>
              </select>
              <div id="netbankingExtra" style="display:none;">
                <label for="bankPhone" class="form-label mt-2">Phone Number (linked to bank)</label>
                <input type="text" id="bankPhone" class="form-control w-50" placeholder="Enter 10-digit phone number">
                <label for="bankOtp" class="form-label mt-2">OTP</label>
                <input type="text" id="bankOtp" class="form-control w-50" placeholder="Enter 6-digit OTP">
              </div>
            </div>
            <button id="payBtn" class="btn btn-success">Pay</button>
            <div id="paymentStatus" class="mt-2"></div>
          </div>
        </div>
      </div>
    </div>
    <script src="{% static 'hosp/patient_log.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
